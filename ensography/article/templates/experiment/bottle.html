{% extends "article/base.html" %}

{% block styles %}
<link rel="stylesheet" href="/static/01-ensography/bottle/bottle-experiment.css">
{% endblock  %}


{% block body %}
<div class="brick32"></div>
<div class="wrapper-main">
    <div class="paper-sheet paper-main paper-typeface article-title-sheet">
        <img width="120" height="120" src="/static/01-ensography/bottle/portfolio/app-icon.png" />
        <h1>The Bottle Experiment</h1>
        <div class="justify">
        <p>
            <em>Bottle</em> is the anonymous image messaging network where users send photo-answers to incoming messages. It is described in the section 2.3 of <em>Above Photography</em> research.
        </p>
        <p>
            Current section of research welcomes co-researchers to take part in the simulation of how the app should work: which behavioral patterns would appear under various circumstances. In particular, this little experiment allows co-researchers to play: to upload their own photographs in response to simulated ‘incoming bottles’.
        </p>
        
        </div>
    </div>
</div>

<div class="wrapper-experiment">
    <div class="experiment-auth">
        <div class="chrome-text-typeface">
            <p><strong>Please introduce yourself</strong></p>
            <p>
                None of personal data collected will be used: all data-sets will be anonymised. Facebook authorisation is only a way to verify participants’ good intentions and to provide them with decent way to manage their data afterwards.
            </p>
        </div>
        <div class="experiment-auth-icon">
            <div class="icon icon--facebook clearfix icon-always-visible-label js-auth">
                <div class="icon-img icon-static"></div>
                <div class="icon-text chrome-label-typeface">Sign in with Facebook</div>
            </div>
        </div>
    </div>
    <div class="experiment-auth-complete">
        <div class="userpic userpic-nyaremko"></div>
        <div class="chrome-text-typeface">
            <p><strong>Welcome, Nikolay Yaremko!</strong></p>
            <p>
                You will see a photograph below. Please upload your photo-answer accordingly, and you will see collected
                works of whole research group. Proceed to the next photograph, and so on, and so on, and on and on. And on.
            </p>
        </div>
    </div>
</div>

<div class="brick64"></div>
<div class="brick64"></div>
<div class="brick64"></div>


<style type="text/css">
.wrapper-hidden {
    display: none;
}
</style>
<div class="wrapper-hidden">
    <div class="experiment-auth">
        <div class="chrome-text-typeface">
            <p><strong>Please introduce yourself</strong></p>
            <p>
                None of personal data collected will be used: all data-sets will be anonymised. Facebook authorisation is only a way to verify participants’ good intentions and to provide them with decent way to manage their data afterwards.
            </p>
        </div>
        <div class="experiment-auth-icon">
            <div class="icon icon--facebook clearfix icon-always-visible-label">
                <div class="icon-img icon-static"></div>
                <div class="icon-text chrome-label-typeface">Sign in with Facebook</div>
            </div>
        </div>
    </div>
    <div class="experiment-auth-complete">
        <div class="userpic userpic-nyaremko"></div>
        <div class="chrome-text-typeface">
            <p><strong>Welcome, Nikolay Yaremko!</strong></p>
            <p>
                You will see a photograph below. Please upload your photo-answer accordingly, and you will see collected
                works of whole research group. Proceed to the next photograph, and so on, and so on, and on and on. And on.
            </p>
        </div>
    </div>

    <div class="experiment-add clearfix">
        <div class="experiment-add-container">
            <div class="bottle bottle-full">
                <div class="bottle-bg-full"></div>
            </div>
        </div>
        <iframe src="/experiment/bottle_iframe?question"></iframe>
    </div>

    <div class="experiment-one experiment-one-state-start">
        <div class="bottle bottle-full">
            <div class="bottle-bg-empty"></div>
            <div class="bottle-bg-full"></div>
        </div>
        <div class="experiment-photo photo photo-rotate-1">
            <img src="/static/data/bottle/1.jpg">
        </div>
        <iframe src="/experiment/bottle_iframe"></iframe>
        <div class="experiment-one-results clearfix">
            <div class="experiment-one-results-pan"></div>
            <div class="photo">
                <img src="/static/data/bottle/2.jpg">
            </div>
            <div class="photo">
                <img src="/static/data/bottle/1.jpg">
            </div>
            <div class="photo">
                <img src="/static/data/bottle/2.jpg">
            </div>
            <div class="photo">
                <img src="/static/data/bottle/2.jpg">
            </div>
            <div class="photo">
                <img src="/static/data/bottle/1.jpg">
            </div>
            <div class="photo">
                <img src="/static/data/bottle/2.jpg">
            </div>
            <div class="photo">
                <img src="/static/data/bottle/2.jpg">
            </div>
            <div class="photo">
                <img src="/static/data/bottle/1.jpg">
            </div>
            <div class="photo">
                <img src="/static/data/bottle/2.jpg">
            </div>
        </div>
    </div>


</div>

<div class="brick64"></div>
<div class="brick64"></div>
<div class="brick64"></div>
{% endblock  %}
{% block jquery %}
<script type="text/javascript" src="/static/01-ensography/bottle/bottle-experiment.js"></script>
<script type="text/javascript">
    var user = false;
    {% if request.user.is_authenticated %}
        user = {
            success: true,
            name: '{{ request.user.get_full_name }}',
            id: '{{ request.user.username }}',
            userpic: '{{ request.user.get_userpic }}',
            email: '{{ request.user.email }}'
        };
    {% endif %}
    preload([], function() {
        window.Comments.prototype.onAuth = function(user) {
            window.BottleExperiment.prototype.onAuth(user)
        }
        var b = new BottleExperiment('.wrapper-experiment', user);
    });
    /*
        TODO REFACTOR
        function simulate_results() {
            $('.experiment-one').removeClass('experiment-one-state-start').addClass('experiment-one-state-results');
        }
        function simulate() {
            var $e = $('.experiment-one');
            var animation_time = 0;
            var animation = [
                ['start', 0], 
                ['incoming', 750], 
                ['open', 250, 
                    function($context) { $context.find('.bottle').addClass('bottle-empty').removeClass('bottle-full') }],
                ['enlarge', 750, function($context) { 
                    $context.find('.photo').addClass('photo-rotate-'+parseInt(Math.random()*6+1)) }],
                ['upload']
            ];
            var prefix = 'experiment-one-state-';
            for (var i=0; i<animation.length; i++) {
                (function(){
                    var this_state = animation[i];
                    var next_state = (i+1 == animation.length) ? false : animation[i+1];
                    animation_time += this_state[1];
                    if (next_state) setTimeout(function(){
                        $e.removeClass(prefix+this_state[0]).addClass(prefix+next_state[0]);
                        if (next_state[2]) next_state[2]($e);
                    }, animation_time)
                })();
            }
        }
        simulate();
        $('.curtain').click(function(){ $($('html').data('curtain-click')).click(); })
        $('.photo-enlarged').click
        $('.wrapper-experiment').on('click', '.experiment-one-results .photo', function(){
            var $photo = $('<div class="photo">'+$(this).html()+'</div>');
            $photo.addClass('photo-enlarged')
                  .css({
                    position: 'fixed',
                    'z-index': 1000,
                    left: '50%', top: '50%',
                    margin: '-320px 0 0 -320px'
                  })
                  .click(function(){
                    $('html').removeClass('blocked');
                    $(this).remove();
                  })
            $('body').append($photo);
            $('html').addClass('blocked');
            $('html').data('curtain-click', '.photo-enlarged')
        })
    */
</script>
{% endblock  %}